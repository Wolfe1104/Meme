 <!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Meme Creator Studio</title>
    <link rel="manifest" href="manifest.json">
    <link rel="icon" href="icon-192.png" type="image/png">
    <style>
        body { font-family: Arial, sans-serif; background: #121212; color: #fff; margin: 0; padding: 20px; text-align: center; }
        h1 { color: #ff4081; }
        .container { max-width: 800px; margin: 0 auto; }
        .templates { display: flex; flex-wrap: wrap; justify-content: center; gap: 10px; margin: 20px 0; }
        .template-img { width: 150px; cursor: pointer; border: 3px solid #333; border-radius: 8px; transition: border 0.3s; }
        .template-img:hover, .template-img.selected { border-color: #ff4081; }
        #canvas { max-width: 100%; border: 2px solid #ff4081; border-radius: 8px; margin: 20px 0; background: #000; }
        input { padding: 10px; margin: 10px; width: 80%; max-width: 400px; font-size: 18px; border-radius: 8px; border: none; }
        button { padding: 15px 30px; font-size: 18px; background: #ff4081; color: white; border: none; border-radius: 8px; cursor: pointer; margin: 10px; }
        button:hover { background: #f50057; }
    </style>
</head>
<body>
    <div class="container">
        <h1>Meme Creator Studio ðŸŽ¨</h1>
        <p>Select a template, add text, and download your meme! Works offline.</p>
        
        <div class="templates" id="templates"></div>
        
        <input type="text" id="topText" placeholder="Top Text (optional)" maxlength="50">
        <input type="text" id="bottomText" placeholder="Bottom Text (optional)" maxlength="50">
        
        <canvas id="canvas" width="500" height="500"></canvas>
        
        <br>
        <button onclick="drawMeme()">Update Preview</button>
        <button onclick="downloadMeme()">Download Meme</button>
    </div>

    <script>
        const templates = [
            { name: "Drake Hotline Bling", url: "https://i.imgflip.com/30b1gx.jpg" }, // Popular ones from public sources
            { name: "Distracted Boyfriend", url: "https://i.imgflip.com/1ur9b0.jpg" },
            { name: "Change My Mind", url: "https://i.imgflip.com/24y43o.jpg" },
            { name: "Expanding Brain", url: "https://i.imgflip.com/1jwhkz.jpg" },
            { name: "Success Kid", url: "https://i.imgflip.com/1bhk.jpg" },
            { name: "One Does Not Simply", url: "https://i.imgflip.com/1bij.jpg" }
        ];

        const canvas = document.getElementById('canvas');
        const ctx = canvas.getContext('2d');
        let currentImg = new Image();

        // Load templates
        const templatesDiv = document.getElementById('templates');
        templates.forEach((temp, index) => {
            const img = document.createElement('img');
            img.src = temp.url;
            img.alt = temp.name;
            img.classList.add('template-img');
            img.onclick = () => selectTemplate(temp.url, img);
            templatesDiv.appendChild(img);
            if (index === 0) selectTemplate(temp.url, img); // Default first
        });

        function selectTemplate(url, element) {
            document.querySelectorAll('.template-img').forEach(i => i.classList.remove('selected'));
            element.classList.add('selected');
            currentImg.src = url;
            currentImg.onload = drawMeme;
        }

        function drawMeme() {
            // Resize canvas to image aspect
            canvas.width = currentImg.width;
            canvas.height = currentImg.height;
            ctx.drawImage(currentImg, 0, 0);

            ctx.font = 'bold 40px Impact';
            ctx.fillStyle = 'white';
            ctx.strokeStyle = 'black';
            ctx.lineWidth = 4;
            ctx.textAlign = 'center';

            const top = document.getElementById('topText').value.toUpperCase();
            const bottom = document.getElementById('bottomText').value.toUpperCase();

            if (top) {
                ctx.strokeText(top, canvas.width / 2, 60);
                ctx.fillText(top, canvas.width / 2, 60);
            }
            if (bottom) {
                ctx.strokeText(bottom, canvas.width / 2, canvas.height - 20);
                ctx.fillText(bottom, canvas.width / 2, canvas.height - 20);
            }
        }

        function downloadMeme() {
            const link = document.createElement('a');
            link.download = 'my-meme.png';
            link.href = canvas.toDataURL('image/png');
            link.click();
        }

        // Initial draw
        drawMeme();

        // Live update on input
        document.getElementById('topText').addEventListener('input', drawMeme);
        document.getElementById('bottomText').addEventListener('input', drawMeme);

        // Service Worker
        if ('serviceWorker' in navigator) {
            navigator.serviceWorker.register('sw.js');
        }
    </script>
</body>
</html>
